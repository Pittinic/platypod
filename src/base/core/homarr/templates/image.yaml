resources:
  # https://github.com/pulumi/pulumi-docker-build/blob/main/examples/yaml/Pulumi.yaml
  docker-image-homarr:
    type: docker-build:Image
    options:
      dependsOn:
      - ${docker-image-builder}
    properties:
      buildArgs:
        BUILDER_IMAGE: ${docker.images.registry}${docker.images.namespace}${image-builder.name}:${image-builder.tag}
        SOURCE_IMAGE: ${docker.images.registry}${docker.images.namespace}${homarr.image.repository}:${homarr.image.tag}
        WHOAMI_URL: ${urls.prefix}${whoami.name}${urls.suffix}.${domain}
        JELLYFIN_HOST: ${urls.prefix}${jellyfin.name}${urls.suffix}.${domain}
        JELLYFIN_USERNAME: ${jellyfin.credentials.username}
        JELLYFIN_PASSWORD: ${jellyfin.credentials.password}
      context:
        location: src/base/core/homarr/images
      dockerfile:
        location: src/base/core/homarr/images/Dockerfile
      platforms: ${docker.images.platforms}
      push: ${docker.images.push}
      registries: ${docker.registries}
      tags:
      - ${docker.images.registry}${docker.images.namespace}${homarr.image.repository}:${homarr.image.tag}
